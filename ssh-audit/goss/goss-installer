#!/bin/sh
set -eu

GOSS_VER="${GOSS_VER:-v0.4.9}"
GOSS_DST="${GOSS_DST:-/goss}"

ARCH=$(uname -m)
case ${ARCH} in
    x86_64)  GOSS_ARCH="amd64" ;;
    aarch64) GOSS_ARCH="arm64" ;;
    arm64)   GOSS_ARCH="arm64" ;;
    *)       echo "Unsupported architecture: ${ARCH}"; exit 1 ;;
esac

curl -fsSL "https://github.com/goss-org/goss/releases/download/${GOSS_VER}/goss-linux-${GOSS_ARCH}" \
    -o "${GOSS_DST}/goss"
chmod 0755 "${GOSS_DST}/goss"

echo "Installed goss ${GOSS_VER} for ${GOSS_ARCH} to ${GOSS_DST}/goss"
